<div class="container">
  <div class="titre">
    <span id="worldname" style="top: 50%; position: relative">{{
      world.name
    }}</span>
  </div>

  <div class="header">
    <span
      >Joueur :
      <input type="text" [(ngModel)]="username" (change)="onUsernameChanged()"
    /></span>
    <span>Argent gagn√© : {{ world.money }}</span>
    <button mat-raised-button (click)="nextMultiplier()">
      {{ multiplier }}
    </button>
  </div>

  <div class="logo">
    <span><img [attr.src]="server + world.logo" /></span>
  </div>
  <div class="container2">
    <div class="bandeau">
      <ul>
        <li>
          <button
            mat-raised-button
            color="primary"
            (click)="showUnlocks = true"
            style="width: 150px; margin: 0 0 5px 0"
          >
            Unlocks
          </button>
        </li>
        <li>
          <button
            mat-raised-button
            [matBadge]="badgeUpgrades"
            [matBadgeHidden]="badgeUpgrades == 0"
            (click)="showUpgrades = true"
            style="width: 150px; margin: 0 0 5px 0"
          >
            Cash Upgrades
          </button>
        </li>
        <li>
          <button mat-raised-button style="width: 150px; margin: 0 0 5px 0">
            Angel Upgrades
          </button>
        </li>

        <li>
          <button
            mat-raised-button
            [matBadge]="badgeManagers"
            [matBadgeHidden]="badgeManagers == 0"
            style="width: 150px; margin: 0 0 5px 0"
            (click)="openDialogWithTemplateRef(myDialog2)"
          >
            Managers
          </button>
        </li>
        <li>
          <button
            mat-raised-button
            (click)="showInvestors = true"
            style="width: 150px; margin: 0 0 5px 0"
          >
            Investors
          </button>
        </li>
      </ul>
    </div>

    <div class="central">
      <app-product
        [prod]="p"
        [server]="server"
        [multiplier]="multiplier"
        [money]="world.money"
        class="product col-md-6"
        *ngFor="let p of world.products.product"
        (notifyProduction)="onProductionDone($event)"
        (notifyBuy)="onBuy($event)"
      ></app-product>
    </div>
  </div>

  <div *ngIf="showUnlocks" class="modal">
    <div>
      <h1 class="title">
        Want to maximize profits? Get your investments to these quotas!
      </h1>
    </div>
    <div>
      <div *ngFor="let product of world.products.product">
        <div *ngFor="let unlock of product.palliers.pallier">
          <div *ngIf="!unlock.unlocked" class="unlockslayout">
            <div>
              <div class="logo">
                <img class="round" [attr.src]="server + unlock.logo" />
              </div>
            </div>
            <div>
              <div class="unlockname">{{ unlock.name }}</div>
              <div class="unlockcible">
                {{ world.products.product[unlock.idcible - 1].name }}
              </div>
              <div>{{ unlock.typeratio }} x {{ unlock.ratio }}</div>
              <div class="unlockscost">{{ unlock.seuil }}</div>
            </div>
          </div>
        </div>
      </div>
      <div *ngFor="let unlock of world.allunlocks.pallier">
        <div *ngIf="!unlock.unlocked" class="unlockslayout">
          <div>
            <div class="logo">
              <img class="round" [attr.src]="server + unlock.logo" />
            </div>
          </div>
          <div>
            <div class="unlockname">{{ unlock.name }}</div>
            <div class="unlockcible">
              {{ world.products.product[unlock.idcible - 1].name }}
            </div>
            <div>{{ unlock.typeratio }} x {{ unlock.ratio }}</div>
            <div class="unlockscost">{{ unlock.seuil }}</div>
          </div>
        </div>
      </div>
      <button
        class="closebutton"
        mat-raisedbutton
        color="primary"
        (click)="showUnlocks = !showUnlocks"
      >
        Close
      </button>
    </div>
  </div>

  <div *ngIf="showUpgrades" class="modal">
    <div>
      <h1 class="title">Boost your investments!</h1>
    </div>
    <div>
      <div *ngFor="let upgrade of world.upgrades.pallier">
        <div *ngIf="!upgrade.unlocked" class="upgradelayout">
          <div>
            <div class="logo">
              <img class="round" [attr.src]="server + upgrade.logo" />
            </div>
          </div>
          <div>
            <div class="upgradename">{{ upgrade.name }}</div>
            <div class="upgradecible">
              {{ world.products.product[upgrade.idcible - 1].name }}
            </div>
            <div>{{ upgrade.typeratio }} x {{ upgrade.ratio }}</div>
            <div class="upgradescost">{{ upgrade.seuil }}</div>
            <div>
              <button
                class="upgradebutton"
                mat-raisedbutton
                (click)="buyUpgrade(upgrade)"
                [disabled]="upgrade.seuil > world.money"
              >
                Buy!
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <button
      class="closebutton"
      mat-raisedbutton
      color="primary"
      (click)="showUpgrades = !showUpgrades"
    >
      Close
    </button>
  </div>
  <div *ngIf="showInvestors" class="modal">
    <div>
      <h1 class="title">Angel investors</h1>
    </div>
    <div>
      <p>{{ world.totalangels }} Total angels</p>
      <p>2% bonus per angel</p>
      <button class="angelbutton" mat-raisedbutton (click)="claimAngels()">
        {{ angelsToClaim }} angels to claim with restart
      </button>
    </div>
    <button
      class="closebutton"
      mat-raisedbutton
      color="primary"
      (click)="showInvestors = !showInvestors"
    >
      Close
    </button>
  </div>
</div>

<ng-template #myDialog2>
  <h2 matDialogTitle>Managers make you feel better !</h2>

  <mat-dialog-content>
    <div *ngFor="let manager of world.managers.pallier">
      <div *ngIf="!manager.unlocked" class="managerslayout">
        <div class="one">
          <img class="round" [attr.src]="server + manager.logo" />
        </div>

        <div class="two">
          <b>Manager : </b>{{ manager.name }} <br />
          <b>Voiture : </b
          >{{ world.products.product[manager.idcible - 1].name }}
          <br />
          <b>Prix : </b>{{ manager.seuil }} <br />

          <button
            class="hirebutton"
            mat-raisedbutton
            (click)="hireManager(manager)"
            [disabled]="manager.seuil > world.money"
          >
            Hire !
          </button>
        </div>
      </div>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button matDialogClose color="primary">Fermer</button>
  </mat-dialog-actions>
</ng-template>
